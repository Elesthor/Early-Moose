accept(sock, 2001).
new seed.

% clef RSA
pkrsa = pk(seed, RSA).
skrsa = sk(seed, RSA).
out(sock, pkrsa).

% clef AES
in(sock, kaes_enc).
kaes = dec(kaes_enc, skrsa).


% la connexion est prÃªte
out(sock, enc(coucou, kaes, seed)).
close(sock)
